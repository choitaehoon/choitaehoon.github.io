---
title: "scale-out vs scale-in"
date: 2020-10-03 14:15:00 
---

### 배경

로그인 할 때 트래픽이 많이 들어오게 되면 서버 다운 될 가능성이 있습니다. 이를 회피 하기 위해 Scale-up과 Scale-down의 장단점들을 찾아보고
현재 진행하고 있는 프로젝트에 어떤 걸 적용할지 파악해보겠습니다.

### Scale-up과 Scale-out 정의

![image](https://user-images.githubusercontent.com/33123391/94989760-0ae48c80-05b2-11eb-889d-ac8d1f1b4eef.png)

Scale-in은 서버에 CPU, RAM등을 추가하거나 고성능의 부품, 서버로 교환하는 방법을 의미합니다. 스케일업 방식은 서버 한대에 모든 부하가 집중되므로 장애시 크게 영향을 받을 수 있는 위험성이 존재합니다. 
한 대의 서버에 모든 데이터를 처리하므로 데이터 갱신이 빈번하게 일어나는 `데이터베이스 서버` 에 적합한 방식입니다.

Scale-out은 서버 여러대를 추가하여 시스템을 확장하는 방법입니다. 서버 여러대가 추가되기 때문에 각 서버에 걸리는 부하를 균등하게 해주는 `로드밸런싱` 이 필수적으로 동반되어야 합니다.
스케일 아웃은 서버 한 대가 장애로 다운되더라도 다른 서버로 서비스를 제공이 가능하다는 장점이 있습니다. 

### 장단점 비교
![image](https://user-images.githubusercontent.com/33123391/94989793-51d28200-05b2-11eb-9901-bb80a4e153cc.png)


### Scale-out 적용

진행하고 있는 프로젝트에 Scale-out을 선택했습니다. 이유는 아래와 같습니다.
1. 트래픽이 많아져 서버가 다운되는 현상은 치명적인 상황입니다. Scale-out을 적용하여 부하 분산을 함으로써 서버의 부하를 낮출 수 있고
서버가 다운 되더라도 살아있는 서버를 바라보게 함으로써 해결 할 수 있습니다.

2. 지속적인 확장이 가능합니다. 서버의 부하 분산을 위해 여러대의 서버를 구축했다 하더라도 많은 트래픽이 발생하게 되면 다운 될 가능성은 여전히 남아 있습니다.
이때 서버 증설 확장에 대한 검토를 진행하고 문제가 없다고 판단되면 확장하면 됩니다. 

3. Scale-up보다 저렴합니다. 서버 성능이 증가함에 따라 비용 증가폭이 큽니다. 하지만 Scale-out은 비교적 저렴한 서버 사용을 증설하여 
트래픽 부하 분산시킴으로써 해결 할 수 있습니다.

### Scale-out의 문제점
Scale-out을 적용한 이유만 보면 무조건 Scale-out만 사용해야 한다고 느낄 수 있습니다. 하지만 Scale-out에서도 문제점이 발생할 수 있는데 이유는 아래와 같습니다.
1. 설계, 구현의 복잡성이 증가하는문제로 아키텍처(로드 밸런싱)에 대한 높은 이해도가 필요합니다.
2. 코어 개수와 성능이 비례하지 않습니다. 코어를 증가시키면 서버 성능이 올라갈거라 기대합니다. 하지만 코어 개수에 따라 대역폭이 증가하기 때문에
 무조건 서버 성능을 높일 수 있는건 아닙니다.
3. 각각의 서버 세션을 이용하여 데이터 정합성 이슈가 발생하게 됩니다.

### Scale-out 문제 해결 방안
1. 아키텍처에 대해 깊게 공부하고 적용합니다.
2. 확장이 필요 하다면 충분히 고려 한 후에 적용합니다.
3. 세션 스토리지를 구성하여 각각의 서버에 대한 세션을 복제해 데이터 정합성 이슈를 해결합니다. 